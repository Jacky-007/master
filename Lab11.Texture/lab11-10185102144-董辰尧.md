# 华东师范大学计算机科学与技术实验报告

| 实验课程：计算机图形学 | 年级：18级        | 实验成绩：            |
| ---------------------- | ----------------- | --------------------- |
| 实验名称：材质贴图     | 姓名：董辰尧      | 实验日期：2021/5/18   |
| 实验编号：11           | 学号：10185102144 | 实验时间：13:00~14:40 |
| 指导教师：李洋、王长波 | 组号：            |                       |

## 一、实验目的

利用HLSL实现基本材质贴图。

## 二、实验环境

VS2017

## 三、实验内容

1. 阅读代码
2. 根据ppt中内容，在main.cpp中创建贴图
3. 根据ppt内容，在shader中实现贴图渲染，将贴图渲染结合到phong模型中

## 四、实验过程与分析

* **纹理渲染：**为了使绘制出来的模型具有很强的真实感，需要借助编程接口—DirectX对模型进行纹理贴图，达到还原的真实感。纹理指的是三维物体表面的图案和花纹。纹理贴图是指采用贴图的方法，将一张二维的图像贴到三维物体表面，形成三维物体表面的纹理。纹理和材质一样是物体表面的属性，结合纹理，材质和光照对三维场景进行渲染，可以使渲染的图形更加逼真。

* **代码补充：**这次需要补充的代码都放在了ppt里，需要找到合适的位置进行补充调整，由于代码几乎和ppt一样，这里就不贴上代码块了。

* **将贴图渲染结合到phong模型中：**这次需要自己完成的是把贴图渲染和上一次光照结合，主要代码如下：

  ``` c++
  float4 ps_main(VertexOut input) : SV_TARGET
  {
      float3 to_eye = normalize(view_pos - input.pos_w);
      input.normal = normalize(input.normal);
  
      float4 ambient, diffuse, specular;
      float4 A, D, S;
      ambient = diffuse = specular = float4(0.0f, 0.0f, 0.0f, 0.0f);
  
  	float4 tex_color = box_texture.Sample(box_sampler, input.texcoord);
  
      CalcDirectionalLight(material, dir_light, input.normal, to_eye, A, D, S);
      ambient += A;
      diffuse += D;
      specular += S;
  
      CalcPointLight(material, point_light, input.pos_w, input.normal, to_eye, A, D, S);
      ambient += A;
      diffuse += D;
      specular += S;
  
  // @TODO : modify the shader to use texture
  
      return  tex_color * (ambient + diffuse) + specular ;
  }
  ```

  注意不是简单的把tex_color直接加到结果里，需要对每一个点进行改变，于是使用乘法。

## 五、实验过程总结

* 结果截图：

  ![image-20210518150306277](C:\Users\summer\AppData\Roaming\Typora\typora-user-images\image-20210518150306277.png)

* 总结：这节课成功让图形更加逼真了，代码虽然都给出来了，但是还是要注意不要敲错。我就因为hlsl文件中的两处分号打成了中文的分号而一直报错。

